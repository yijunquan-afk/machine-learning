# 机器学习——02 k-近邻算法

## 参考资料

1. [AIlearning](https://ailearning.apachecn.org/#/docs/ml/2)
2. 庞善民.西安交通大学机器学习导论2022春PPT

## 一、KNN概述

**k-近邻（kNN, k-NearestNeighbor）算法**是一种基本分类与回归方法，这里只讨论分类问题中的 k-近邻算法。

k 近邻算法的输入为实例的特征向量，对应于特征空间的点；输出为实例的类别，可以取多类。k 近邻算法假设给定一个训练数据集，其中的实例类别已定。分类时，对新的实例，根据其 k 个最近邻的训练实例的类别，通过多数表决等方式进行预测。因此，k近邻算法不具有显式的学习过程。

k 近邻算法实际上利用训练数据集对特征向量空间进行划分，并作为其分类的“模型”。 **k值的选择、距离度量以及分类决策规则**是k近邻算法的三个基本要素。

KNN算法本身简单有效，它是一种lazy- learning算法

## 二、应用场景

电影可以按照题材分类，那么如何区分 `动作片` 和 `爱情片` 呢？

1. 动作片: 打斗次数更多
2. 爱情片: 亲吻次数更多

基于电影中的亲吻、打斗出现的次数，使用 k-近邻算法构造程序，就可以自动划分电影的题材类型。

| 电影名称                   | 打斗镜头 | 接吻镜头 | 电影类型 |
| -------------------------- | -------- | -------- | -------- |
| California Man             | 3        | 104      | 爱情片   |
| He's Not Really into Dudes | 2        | 100      | 爱情片   |
| Beautiful Woman            | 1        | 81       | 爱情片   |
| Kevin Longblade            | 101      | 10       | 动作片   |
| Robo Slayer 3000           | 99       | 5        | 动作片   |
| Amped 11                   | 98       | 2        | 动作片   |
| ？                         | 18       | 90       | 未知     |

<p align="center">table 1 : 每部电影的打斗镜头数、接吻镜头数以及电影评估类型
电影名称

| 电影名称                   | 与未知电影的距离 |
| -------------------------- | ---------------- |
| California Man             | 20.5             |
| He's Not Really into Dudes | 18.7             |
| Beautiful Woman            | 19.2             |
| Kevin Longblade            | 115.3            |
| Robo Slayer 3000           | 117.4            |
| Amped 11                   | 118.9            |

<p align="center">table 2 : 已知电影与未知电影的距离

现在根据上面我们得到的样本集中所有电影与未知电影的距离，按照距离递增排序，可以找到 k 个距离最近的电影。 假定 k=3，则三个最靠近的电影依次是， He's Not Really into Dudes 、 Beautiful Woman 和 California Man。 knn 算法按照距离最近的三部电影的类型，决定未知电影的类型，而这三部电影全是爱情片，因此我们判定未知电影是爱情片。

## 三、KNN原理

### 分类原理

对一个未知样本进行分类：

> :one: 计算未知样本与标记样本的距离(最废时)
>
> :two: 确定k个近邻（超参，不鲁棒）
>
> :three: 使用近邻样本的标签确定目标的标签：例如，**将其划分到k个样本中出现最频繁的类**

### 通俗解释

给定一个训练数据集，对新的输入实例，在训练数据集中找到与该实例最邻近的 k 个实例，这 k 个实例的多数属于某个类，就把该输入实例分为这个类。

### 开发流程

1. 收集数据: 任何方法 
2. 准备数据: 距离计算所需要的数值，最好是结构化的数据格式 
3. 分析数据: 任何方法 
4. 训练算法: 此步骤不适用于 k-近邻算法 
5. 测试算法: 计算错误率 
6. 使用算法: 输入样本数据和结构化的输出结果，然后运行 k-近邻算法判断输入数据分类属于哪个分类，最后对计算出的分类执行后续处理

### 算法特点

优点: 精度高、对异常值不敏感、无数据输入假定 

缺点: 计算复杂度高、空间复杂度高 

适用数据范围: 数值型和标称型

## 四、实际项目案例

### 项目概述

海伦使用约会网站寻找约会对象。经过一段时间之后，她发现曾交往过三种类型的人:

- 不喜欢的人
- 魅力一般的人
- 极具魅力的人

她希望:

1. 工作日与魅力一般的人约会
2. 周末与极具魅力的人约会
3. 不喜欢的人则直接排除掉

现在她收集到了一些约会网站未曾记录的数据信息，这更有助于匹配对象的归类。

### 开发流程

收集数据: 提供文本文件 

准备数据: 使用 Python 解析文本文件 

分析数据: 使用 Matplotlib 画二维散点图 

训练算法: 此步骤不适用于 k-近邻算法 

测试算法: 使用海伦提供的部分数据作为测试样本。        

测试样本和非测试样本的区别在于: 测试样本是已经完成分类的数据，如果预测分类与实际类别不同，则标记为一个错误。 

使用算法: 产生简单的命令行程序，然后海伦可以输入一些特征数据以判断对方是否为自己喜欢的类型。